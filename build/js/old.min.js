function isAndroid(){var a=navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/.test(a)?!1:/android/.test(a)?!1:void 0}function go_one(){JT.to(css3d.dotted.el,1,{onRepeat:!1,ease:JT.Linear.None,onUpdate:function(){dotted_z=0>=dotted_z-4*ratio?0:dotted_z-4*ratio,css3d.dotted.position(0,0,dotted_z).updateT()},onEnd:function(){orienter.init()}})}function go_two(){JT.to(css3d.camera.stage.el,10,{onRepeat:!1,ease:JT.Linear.None,onUpdate:function(){a-=4*ratio,css3d.camera.position(0,0,a).updateT(),canMove?b-410*ratio>a&&(initNext(),JT.kill(css3d.camera.stage.el)):(b=a,css3d.four.position(0,0,a-400*ratio).updateT(),css3d.bgPlane.position(0,0,a-410*ratio).updateT())},onEnd:function(){initNext(),JT.kill(css3d.camera.stage.el)}})}function initNext(){$(".page1").hide(),$("#box1").html(" "),$("#box1").remove(),css3d.end(),newCss3.start()}function create(){if(!isAndroid()){css3d.n_s=new C3D.Sprite;for(var a=0;10>a;a++){var b=new C3D.Plane;b.size(310*ratio,402*ratio),b.rotation(10*Math.random(),10*Math.random(),100*Math.random()),b.position(100*Math.random()-50,100*-Math.random(),200*-a*ratio),b.material({image:"images/dotted2.png"}),b.update(),b.el.style.backgroundSize="100% 100%",css3d.n_s.addChild(b)}css3d.stage.addChild(css3d.n_s)}}function RndNum(a){for(var b="",c=0;a>c;c++)b+=Math.floor(10*Math.random());return b}function selectFileImage(a){var b=a.files[0],c=null;if(b){var d=/^(image\/jpeg|image\/png)$/i;if(!d.test(b.type))return void alert("��ѡ��jpeg��png��ʽ��ͼƬ");EXIF.getData(b,function(){EXIF.getAllTags(this),c=EXIF.getTag(this,"Orientation")});var e=new FileReader;e.onload=function(a){var b=new Image;b.src=a.target.result,b.onload=function(){var a=this.naturalWidth,d=this.naturalHeight;this.naturalWidth>this.naturalHeight&&this.naturalWidth>800?(a=800,d=a*this.naturalHeight/this.naturalWidth):this.naturalHeight>this.naturalWidth&&this.naturalHeight>1200&&(d=1200,a=d*this.naturalWidth/this.naturalHeight);var e=document.createElement("canvas"),f=e.getContext("2d");e.width=a,e.height=d,f.drawImage(this,0,0,a,d);var g=null,h=new MegaPixImage(b);h.render(e,{maxWidth:800,maxHeight:1200,quality:.8,orientation:c}),g=e.toDataURL("image/jpeg",.8),$("#img").css("background-image","url("+g+")");var i=(new Date).getTime(),j=i+RndNum(4),k={user:j,img_base64:g,setting:"Magpie",duang:""};$.ajax({type:"post",url:"http://team.zjqq.mobi/youtu/analysis.php",data:k,dataType:"json",async:!0,error:function(a){showMyTips("�ύʧ�ܣ�������")},success:function(a){console.log(a),$(".imgPath").val(a.path),$(".imgPath_thumb").val(a.path),$(".imgPath_thumb_big").val(a.path)}})}},e.readAsDataURL(b)}}function check_source(){return window.TencentNews?signSource=1:"undefined"!=typeof WeixinJSBridge?signSource=3:navigator.userAgent?signSource=4:signSource=0,signSource}function showMyTips(a){$(".tipsCon .tips p").html(a),$(".tipsCon").fadeIn()}function reg_new(a){if(!$(".imgPath").val())return void showMyTips("���ϴ�һ����Ƭ");$("#"+a+"_reg_button").attr("disabled","disabled");var b=reg_host+"sign/submit/"+a,c=check_source();$.ajax({cache:!1,type:"post",url:b,data:$("#"+a+"_reg_form").serialize()+"&data[signsource]="+c+"&callback=reg_success_callback",async:!1,error:function(b){showMyTips("�ύʧ�ܣ�������"),$("#"+a+"_reg_button").removeAttr("disabled")},success:function(b){return b=JSON.parse(b),"success"==b.result?void showMyTips("�ύ�ɹ�"):(showMyTips(b.result),void $("#"+a+"_reg_button").removeAttr("disabled"))}})}var winWidth=window.innerWidth,winHeight=window.innerHeight,ratio=ratioGlobel/100,a=400*ratio,b=400*ratio,orienter,canMove=!1,firstFlag=!1;localhostPaht="http://vip.zjqq.mobi";var reg_host=localhostPaht+"/index.php/",bgx=-(374*winHeight/568-winWidth)/2,css3d={stage:"",init:function(){var a=this;a.stage=new C3D.Stage,a.stage.size(winWidth,winHeight).update(),a.resize(),a.camera=a.stage.camera,a.camera.position(0,0,400*ratio),a.camera.stage.el.setAttribute("id","camera"),a.camera.update(),a.page1start()},ininStatus:function(){go_one()},page1start:function(){var a=this;document.getElementById("box1").appendChild(a.stage.el),a.skybox=new C3D.Skybox,a.skybox.size(800*ratio).position(0,0,0).update(),a.stage.addChild(a.skybox),a.sprite=new C3D.Sprite,a.dotted=new C3D.Plane,a.dotted.size(316*ratio,402*ratio),a.dotted.material({image:"images/dotted.png"}),a.dotted.position(0,0,200*ratio),a.dotted.el.style.backgroundSize="100% 100%",a.dotted.el.setAttribute("id","dotted"),a.stage.addChild(a.dotted),a.dotted.update(),a.four=new C3D.Plane,a.four.size(50*ratio,61*ratio),a.four.position(0,0,0),a.four.material({image:"images/4.png"}),a.four.el.style.backgroundSize="100% auto",a.four.update(),a.stage.addChild(a.four),a.four.el.style.display="none",a.bgPlane=new C3D.Plane,a.bgPlane.size(600*ratio,800*ratio),a.bgPlane.position(0,0,-10*ratio),a.bgPlane.material({image:"images/page1_bg.jpg"}),a.bgPlane.el.style.backgroundSize="auto 100%",a.bgPlane.el.style.backgroundPosition="center",a.bgPlane.el.style.backgroundRepeat="no-repeat",a.bgPlane.update(),a.stage.addChild(a.bgPlane),a.four.el.style.display="none"},end:function(){$(window).unbind("resize")},resize:function(){var a=this;a.stage.size(window.innerWidth,window.innerHeight).update(),$(window).bind("resize",function(){a.resize()})}},newCss3={init:function(){var a=this;a.stage=new C3D.Stage,a.stage.size(winWidth,winHeight).update(),a.stage.camera.position(0,1e3*ratio,0).rotation(-90,0,0),a.conSprite=new C3D.Sprite,a.boxSkin=new C3D.Skybox,a.photoBox=new C3D.Skybox,a.boxSkin.size(1e3*ratio,2e3*ratio,1e3*ratio),a.photoBox.size(700*ratio,700*ratio,700*ratio),a.photoBox.el.setAttribute("id","photoBox"),a.boxSkin.el.setAttribute("id","boxSkin"),a.conSprite.el.setAttribute("id","conSprite");for(var b=0;4>b;b++)switch(b){case 0:for(var c=0;10>c;c++){p=new C3D.Plane;var d=Math.sqrt(2e3*ratio/Math.PI*(2e3*ratio/Math.PI)-ratio*ratio*2500)*Math.sin(Math.PI/20*c),e=-1*Math.sqrt(2e3*ratio/Math.PI*(2e3*ratio/Math.PI)-ratio*ratio*2500)*Math.cos(Math.PI/20*c);q=new C3D.Plane;var f=Math.sqrt(1400*ratio/Math.PI*(1400*ratio/Math.PI)-ratio*ratio*35*35)*Math.sin(Math.PI/20*c),g=-1*Math.sqrt(1400*ratio/Math.PI*(1400*ratio/Math.PI)-ratio*ratio*35*35)*Math.cos(Math.PI/20*c);p.position(d,0,e),q.position(f,0,g),p.el.style.backgroundSize="100% 100%",q.el.style.backgroundSize="100% 100%",p.size(100*ratio,2e3*ratio).rotate(0,-9*c,0).material({image:"images/skyBox/skyBox_"+(c+15)+".jpg"}).update(),q.size(70*ratio,700*ratio).rotate(0,-9*c,0).material({image:"images/photo/photo_"+(c+15)+".png"}).update(),a.boxSkin.addChild(p),a.photoBox.addChild(q)}break;case 1:for(var c=0;10>c;c++){p=new C3D.Plane;var d=Math.sqrt(2e3*ratio/Math.PI*(2e3*ratio/Math.PI)-ratio*ratio*2500)*Math.cos(Math.PI/20*c),e=Math.sqrt(2e3*ratio/Math.PI*(2e3*ratio/Math.PI)-ratio*ratio*2500)*Math.sin(Math.PI/20*c);q=new C3D.Plane;var f=Math.sqrt(1400*ratio/Math.PI*(1400*ratio/Math.PI)-ratio*ratio*35*35)*Math.cos(Math.PI/20*c),g=Math.sqrt(1400*ratio/Math.PI*(1400*ratio/Math.PI)-ratio*ratio*35*35)*Math.sin(Math.PI/20*c);p.position(d,0,e),q.position(f,0,g),p.el.style.backgroundSize="100% 100%",q.el.style.backgroundSize="100% 100%",p.size(100*ratio,2e3*ratio).rotate(0,-9*c-90,0).material({image:"images/skyBox/skyBox_"+(c+25)+".jpg"}).update(),q.size(70*ratio,700*ratio).rotate(0,-9*c-90,0).material({image:"images/photo/photo_"+(c+25)+".png"}).update(),a.boxSkin.addChild(p),a.photoBox.addChild(q)}break;case 2:for(var c=0;10>c;c++){p=new C3D.Plane;var d=-1*Math.sqrt(2e3*ratio/Math.PI*(2e3*ratio/Math.PI)-ratio*ratio*2500)*Math.sin(Math.PI/20*c),e=Math.sqrt(2e3*ratio/Math.PI*(2e3*ratio/Math.PI)-ratio*ratio*2500)*Math.cos(Math.PI/20*c);q=new C3D.Plane;var f=-1*Math.sqrt(1400*ratio/Math.PI*(1400*ratio/Math.PI)-ratio*ratio*35*35)*Math.sin(Math.PI/20*c),g=Math.sqrt(1400*ratio/Math.PI*(1400*ratio/Math.PI)-ratio*ratio*35*35)*Math.cos(Math.PI/20*c);p.position(d,0,e),q.position(f,0,g),p.el.style.backgroundSize="100% 100%",q.el.style.backgroundSize="100% 100%";var h=c+35>40?c-5:c+35;p.size(100*ratio,2e3*ratio).rotate(0,-9*c-180,0).material({image:"images/skyBox/skyBox_"+h+".jpg"}).update(),q.size(70*ratio,700*ratio).rotate(0,-9*c-180,0).material({image:"images/photo/photo_"+h+".png"}).update(),a.boxSkin.addChild(p),a.photoBox.addChild(q)}break;case 3:for(var c=0;10>c;c++){p=new C3D.Plane;var d=-1*Math.sqrt(2e3*ratio/Math.PI*(2e3*ratio/Math.PI)-ratio*ratio*2500)*Math.cos(Math.PI/20*c),e=-1*Math.sqrt(2e3*ratio/Math.PI*(2e3*ratio/Math.PI)-ratio*ratio*2500)*Math.sin(Math.PI/20*c);q=new C3D.Plane;var f=-1*Math.sqrt(1400*ratio/Math.PI*(1400*ratio/Math.PI)-ratio*ratio*35*35)*Math.cos(Math.PI/20*c),g=-1*Math.sqrt(1400*ratio/Math.PI*(1400*ratio/Math.PI)-ratio*ratio*35*35)*Math.sin(Math.PI/20*c);p.position(d,0,e),q.position(f,0,g),p.el.style.backgroundSize="100% 100%",q.el.style.backgroundSize="100% 100%",p.size(100*ratio,2e3*ratio).rotate(0,-9*c-270,0).material({image:"images/skyBox/skyBox_"+(c+5)+".jpg"}).update(),q.size(70*ratio,700*ratio).rotate(0,-9*c-270,0).material({image:"images/photo/photo_"+(c+5)+".png"}).update(),a.boxSkin.addChild(p),a.photoBox.addChild(q)}}a.conSprite.addChild(a.boxSkin),a.conSprite.addChild(a.photoBox),a.stage.addChild(a.conSprite),document.getElementById("box2").appendChild(a.stage.el),isAndroid()||a.conSprite.position(0,0,-1e3*ratio).rotation(90,0,0).update()},start:function(){var a=this;a.startX=0,a.y=0,setTimeout(function(){firstFlag=!0},2e3),isAndroid()||(JT.fromTo(a.conSprite.el,2,{z:-1e3*ratio,rotationX:90},{z:0,rotationX:0,onEnd:function(){}}),JT.fromTo(a.photoBox.el,2,{rotationY:0},{z:0,rotationY:360}),JT.fromTo(a.boxSkin.el,2,{rotationY:0},{z:0,rotationY:-360}))},moveOut:function(){var a=this;JT.fromTo(a.conSprite.el,2,{scaleX:1,scaleY:1,scaleZ:1,z:0,rotationX:0},{z:-1e3*ratio,scaleX:0,scaleY:0,scaleZ:0,rotationX:90,onEnd:function(){$(".page2").addClass("in"),$("#box1").remove(),a.end()}}),JT.fromTo(a.photoBox.el,2,{rotationY:a.photoBox.rotationY},{z:0,rotationY:a.photoBox.rotationY+360}),JT.fromTo(a.boxSkin.el,2,{rotationY:a.boxSkin.rotationY},{z:0,rotationY:a.boxSkin.rotationY-360})},end:function(){$("#box1").html(" ")},resize:function(){var a=this;a.stage.size(window.innerWidth,window.innerHeight).update(),window.onresize=function(){a.resize()}}},dotted_z=200*ratio,b=0,n=1;document.getElementById("container").addEventListener("touchstart",function(a){a.preventDefault()}),Pace.on("hide",function(a){$(".page1").addClass("active"),$(".wordsCon").fadeIn(),css3d.init(),css3d.ininStatus()}),$(function(){document.querySelectorAll("video");$(".num").css("background-image","url("+num_src+")"),$(".bg").css({"background-position-x":bgx+"px"}),$(document).on("touchstart",".page1,.page2,.box1",function(a){a.preventDefault()}),$(".numCon")[0].addEventListener("webkitAnimationEnd",function(){$(".numBox").hide(),css3d.four.el.style.display="block",canMove=!0}),$(".ready")[0].addEventListener("webkitAnimationEnd",function(){newCss3.init(),$(".page1").one("tap",function(){$(".page1").addClass("out"),$(".bottom").fadeIn(),setTimeout(function(){$(".numCon").show(),create(),go_two()},1e3)})}),orienter=new Orienter;var a=!0,b=0;orienter.orient=function(c){a&&(b=c.g,a=!1),firstFlag&&(initA=c.a,firstFlag=!1);try{newCss3.boxSkin.rotation(0,c.a-initA,0).updateT()}catch(c){}.4*c.g<5&&.4*c.g>-5&&(css3d.camera.rotation(0,.4*c.g,0).updateT(),css3d.dotted.position(4*-c.g,0,0).updateT())},$(document).on("touchstart","#photoBox",function(a){var b=a.targetTouches[0];newCss3.startX=b.pageX}),$(document).on("touchmove","#photoBox",function(a){var b=a.targetTouches[0],c=.01*-(b.pageX-newCss3.startX);newCss3.y+=c,newCss3.photoBox.rotation(0,2*newCss3.y,0).updateT()}),$(document).on("touchend","#photoBox",function(a){var b=a.changedTouches[0];newCss3.startX=b.pageX}),$(document).one("tap","#photoBox",function(a){$(document).off("touchmove","#photoBox"),$(document).off("touchstart","#photoBox"),$(document).off("touchend","#photoBox"),orienter.destroy(),newCss3.moveOut()}),$(document).one("tap",".fromCon form i",function(a){$(".page3").fadeOut()}),$(".tipsCon .tips .sure").on("tap",function(){$(".tipsCon").fadeOut()}),$(document).on("tap",".page2",function(){$(".page3").fadeIn()})});