!function(a){var b="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;"function"==typeof define&&define.amd?define(["exports"],function(c){b.Orienter=a(b,c)}):"undefined"!=typeof exports?a(b,exports):b.Orienter=a(b,{})}(function(a,b){function c(a,b){for(var c in b)a[c]=b[c]}return b=function(){this.initialize.apply(this,arguments)},c(b.prototype,{lon:0,lat:0,direction:0,fix:0,os:"",initialize:function(){switch(this.lon=0,this.lat=0,this.direction=window.orientation||0,this.direction){case 0:this.fix=0;break;case 90:this.fix=-270;break;case-90:this.fix=-90}navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?this.os="ios":this.os=navigator.userAgent.indexOf("Android")>-1||navigator.userAgent.indexOf("Linux")?"android":""},init:function(){this._orient=this.orientHandler.bind(this),window.addEventListener("deviceorientation",this._orient,!1),this._change=this.changeHandler.bind(this),window.addEventListener("orientationchange",this._change,!1)},destroy:function(){window.removeEventListener("deviceorientation",this._orient,!1),window.removeEventListener("orientationchange",this._change,!1)},changeHandler:function(a){this.direction=window.orientation,this.change&&this.change(this.direction)},changeDirectionTo:function(a){this.direction=a},orientHandler:function(a){switch(this.os){case"ios":switch(this.direction){case 0:this.lon=a.alpha+a.gamma,a.beta>0&&(this.lat=a.beta-90);break;case 90:a.gamma<0?this.lon=a.alpha-90:this.lon=a.alpha-270,a.gamma>0?this.lat=90-a.gamma:this.lat=-90-a.gamma;break;case-90:a.gamma<0?this.lon=a.alpha-90:this.lon=a.alpha-270,a.gamma<0?this.lat=90+a.gamma:this.lat=-90+a.gamma}break;case"android":switch(this.direction){case 0:this.lon=a.alpha+a.gamma+30,a.gamma>90?this.lat=90-a.beta:this.lat=a.beta-90;break;case 90:this.lon=a.alpha-230,a.gamma>0?this.lat=270-a.gamma:this.lat=-90-a.gamma;break;case-90:this.lon=a.alpha-180,this.lat=-90+a.gamma}}this.lon+=this.fix,this.lon%=360,this.lon<0&&(this.lon+=360),this.lon=Math.round(this.lon),this.lat=Math.round(this.lat),this.orient&&this.orient.apply(this,[{a:Math.round(a.alpha),b:Math.round(a.beta),g:Math.round(a.gamma),lon:this.lon,lat:this.lat,dir:this.direction}])}}),b});